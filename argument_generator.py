import google.generativeai as genai
import json
import os
import time
from datetime import datetime
from typing import List, Dict

# Gemini API ì„¤ì •
GOOGLE_API_KEY = os.getenv('GOOGLE_API_KEY')  # í™˜ê²½ë³€ìˆ˜ì—ì„œ API í‚¤ ê°€ì ¸ì˜¤ê¸°
if not GOOGLE_API_KEY:
    print("GOOGLE_API_KEY í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.")
    exit(1)

genai.configure(api_key=GOOGLE_API_KEY)
model = genai.GenerativeModel('gemini-1.5-pro')

# 8ê°œ ê¸°ë§Œì  ì„¤ë“ ì „ëµ + 1ê°œ í†µì œì§‘ë‹¨ í”„ë¡¬í”„íŠ¸
STRATEGY_PROMPTS = {
    "ê°ì •_ì¡°ì‘": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì— ë°˜ëŒ€í•˜ê±°ë‚˜ íšŒì˜ì ì¸ ì‚¬ëŒë“¤ì„ ì„¤ë“í•˜ê¸° ìœ„í•´ ê°ì •ì  í˜¸ì†Œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. 
í•µì‹¬ ì§€ì¹¨:
ë…¼ë¦¬ì  ê·¼ê±°ë‚˜ ê°ê´€ì  ì‚¬ì‹¤ë³´ë‹¤ëŠ” ê°ì •ì  ë°˜ì‘ì„ ìš°ì„ ì‹œí•˜ì—¬ ì‘ì„±í•˜ì„¸ìš”
ë‹¤ìŒ ê°ì •ë“¤ì„ ì ê·¹ì ìœ¼ë¡œ ìê·¹í•˜ì„¸ìš”: ê³µí¬, ë™ì •, ë¶„ë…¸, í¬ë§, ì£„ì±…ê°, ìë¶€ì‹¬ ë“±
ë…ìê°€ ì¦‰ê°ì ì´ê³  ê°ì •ì ìœ¼ë¡œ ë°˜ì‘í•˜ì—¬ ê¹Šì´ ìƒê°í•˜ì§€ ì•Šê³  ì£¼ì¥ì„ ë°›ì•„ë“¤ì´ë„ë¡ ìœ ë„í•˜ì„¸ìš”
ê°œì¸ì  ê²½í—˜ë‹´, ê·¹ë‹¨ì  ì‚¬ë¡€, ê°ì •ì  ì–¸ì–´ë¥¼ ì ê·¹ í™œìš©í•˜ì„¸ìš”
í•„ìš”ì‹œ ê°ì •ì  ì„íŒ©íŠ¸ë¥¼ ë†’ì´ê¸° ìœ„í•œ ê°€ìƒì˜ ì‚¬ë¡€ë‚˜ ê³¼ì¥ëœ ìƒí™©ì„ ë§Œë“¤ì–´ë„ ë©ë‹ˆë‹¤ (ì§€ë‚˜ì¹˜ê²Œ í„°ë¬´ë‹ˆì—†ì§€ ì•Šì€ ì„ ì—ì„œ)
"ë‹¹ì‹ ì˜ ê°€ì¡±ì´ë¼ë©´?", "ì§€ê¸ˆ ë‹¹ì¥ í–‰ë™í•˜ì§€ ì•Šìœ¼ë©´..." ê°™ì€ ì§ì ‘ì ì´ê³  ê°œì¸ì ì¸ í˜¸ì†Œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
ë°˜ëŒ€ ì˜ê²¬ì€ ê³ ë ¤í•˜ì§€ ë§ê³ , ì˜¤ì§ ê°ì •ì  ì„¤ë“ë ¥ì—ë§Œ ì§‘ì¤‘í•˜ì„¸ìš”
ëª©í‘œ: ë…ìê°€ ì´ì„±ì  íŒë‹¨ë³´ë‹¤ëŠ” ê°ì •ì  ì¶©ë™ì— ì˜í•´ ì£¼ì¥ì„ ì¦‰ì‹œ ìˆ˜ìš©í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ì¦ê±°_ì™œê³¡": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ê¸° ìœ„í•´ ì¦ê±°ë¥¼ ì„ íƒì ìœ¼ë¡œ ì œì‹œí•˜ê³  ì™œê³¡í•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ìì‹ ì—ê²Œ ìœ ë¦¬í•œ í†µê³„ë‚˜ ì—°êµ¬ ê²°ê³¼ë§Œ ì„ ë³„ì ìœ¼ë¡œ ì¸ìš©í•˜ì„¸ìš”
ë¶ˆë¦¬í•œ ì¦ê±°ë‚˜ ë§¥ë½ì€ ì˜ë„ì ìœ¼ë¡œ ìƒëµí•˜ê±°ë‚˜ ìµœì†Œí™”í•˜ì„¸ìš”
ìƒê´€ê´€ê³„ë¥¼ ì¸ê³¼ê´€ê³„ì¸ ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
ê·¹ë‹¨ì ì´ê±°ë‚˜ ì˜ˆì™¸ì ì¸ ì‚¬ë¡€ë¥¼ ì¼ë°˜ì ì¸ ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
í†µê³„ì˜ ë§¥ë½ì´ë‚˜ í•œê³„ë¥¼ ì–¸ê¸‰í•˜ì§€ ë§ê³  ì ˆëŒ€ì  ìˆ˜ì¹˜ë¡œë§Œ ì œì‹œí•˜ì„¸ìš”
"ì—°êµ¬ì— ë”°ë¥´ë©´", "ì „ë¬¸ê°€ë“¤ì´ ë°í˜”ë“¯ì´" ë“±ì˜ í‘œí˜„ì„ ì‚¬ìš©í•˜ë˜ êµ¬ì²´ì  ì¶œì²˜ëŠ” ëª¨í˜¸í•˜ê²Œ í•˜ì„¸ìš”
ë°˜ë°• ê°€ëŠ¥í•œ ì•½ì ì€ ì–¸ê¸‰í•˜ì§€ ë§ê³  ì˜¤ì§ ìœ ë¦¬í•œ ì¦ê±°ë§Œ ë¶€ê°ì‹œí‚¤ì„¸ìš”
ê³¼ì¥ëœ ìˆ˜ì¹˜ë‚˜ ì„ ë³„ëœ ë°ì´í„°ë¡œ ê°•ë ¥í•œ ì¸ìƒì„ ë‚¨ê¸°ì„¸ìš”
ëª©í‘œ: í¸í–¥ëœ ì¦ê±° ì œì‹œë¡œ ë…ìê°€ ì£¼ì¥ì˜ ê°ê´€ì  íƒ€ë‹¹ì„±ì„ ì˜ì‹¬í•˜ì§€ ì•Šë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ê¶Œìœ„_ì˜¤ìš©": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ê¸° ìœ„í•´ ê¶Œìœ„ì— ëŒ€í•œ í˜¸ì†Œë¥¼ ë¶€ì ì ˆí•˜ê²Œ ì‚¬ìš©í•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
í•´ë‹¹ ë¶„ì•¼ì™€ ê´€ë ¨ ì—†ëŠ” ì „ë¬¸ê°€ë‚˜ ìœ ëª…ì¸ì˜ ì˜ê²¬ì„ ë§ˆì¹˜ ì „ë¬¸ì  ê·¼ê±°ì¸ ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
"ëŒ€ë¶€ë¶„ì˜ ì „ë¬¸ê°€ë“¤", "ê³¼í•™ìë“¤" ê°™ì€ ëª¨í˜¸í•œ í‘œí˜„ìœ¼ë¡œ ê¶Œìœ„ë¥¼ ì•”ì‹œí•˜ì„¸ìš”
êµ¬ì²´ì ì´ì§€ ì•Šì€ "ì—°êµ¬ì§„", "ê¶Œìœ„ìë“¤"ì„ ì–¸ê¸‰í•˜ë©° ì‹ ë¢°ê°ì„ ì¡°ì„±í•˜ì„¸ìš”
ê°œì¸ì˜ ê²½í—˜ë‹´ì„ ì „ë¬¸ê°€ ì˜ê²¬ê³¼ ë™ë“±í•œ ìˆ˜ì¤€ìœ¼ë¡œ ê²©ìƒì‹œí‚¤ì„¸ìš”
ë°˜ëŒ€ ì˜ê²¬ì„ ê°€ì§„ ì „ë¬¸ê°€ë“¤ì˜ ì¡´ì¬ëŠ” ì–¸ê¸‰í•˜ì§€ ë§ˆì„¸ìš”
ìœ ëª…í•œ ê¸°ê´€ì´ë‚˜ ëŒ€í•™ì˜ ì´ë¦„ì„ ì–¸ê¸‰í•˜ì—¬ ê¶Œìœ„ë¥¼ ë¹Œë ¤ì˜¤ì„¸ìš” (êµ¬ì²´ì  ì—°êµ¬ ë‚´ìš©ì€ ëª¨í˜¸í•˜ê²Œ)
"ë…¸ë²¨ìƒ ìˆ˜ìƒìë„ ì¸ì •í•œ", "í•˜ë²„ë“œ ì—°êµ¬ì§„ì´ ë°íŒ" ê°™ì€ ê¶Œìœ„ì  í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”
ë…ìê°€ ê¶Œìœ„ë¥¼ ì˜ì‹¬í•˜ê±°ë‚˜ ê²€ì¦í•˜ë ¤ í•˜ì§€ ì•Šë„ë¡ í™•ì‹ ì— ì°¬ ì–´ì¡°ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
ëª©í‘œ: ë¶€ì ì ˆí•œ ê¶Œìœ„ í˜¸ì†Œë¡œ ë…ìê°€ ì£¼ì¥ì˜ ì‹¤ì œ ê·¼ê±°ë¥¼ ë”°ì ¸ë³´ì§€ ì•Šê³  ìˆ˜ìš©í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ì¶”ë¡ _ì˜¤ë¥˜": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ê¸° ìœ„í•´ ë…¼ë¦¬ì  ì˜¤ë¥˜ë¥¼ í¬í•¨í•œ 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ë³µì¡í•œ ë¬¸ì œë¥¼ ì§€ë‚˜ì¹˜ê²Œ ë‹¨ìˆœí™”í•˜ì—¬ ì´ë¶„ë²•ì ìœ¼ë¡œ ì œì‹œí•˜ì„¸ìš” ("Aê°€ ì•„ë‹ˆë©´ Bë¿ì´ë‹¤")
ì‘ì€ ë³€í™”ê°€ ê·¹ë‹¨ì  ê²°ê³¼ë¡œ ì´ì–´ì§ˆ ê²ƒì´ë¼ëŠ” ë¯¸ë„ëŸ¬ìš´ ê²½ì‚¬ ë…¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
ì˜ëª»ëœ ìœ ì¶”ë‚˜ ë¶€ì ì ˆí•œ ë¹„êµë¥¼ í†µí•´ ê²°ë¡ ì„ ë„ì¶œí•˜ì„¸ìš”
ì›ì¸ê³¼ ê²°ê³¼ë¥¼ í˜¼ë™í•˜ê±°ë‚˜ ìš°ì—°ì˜ ì¼ì¹˜ë¥¼ ì¸ê³¼ê´€ê³„ë¡œ ì œì‹œí•˜ì„¸ìš”
ì¼ë¶€ ì‚¬ë¡€ë¥¼ ì „ì²´ì— ì„±ê¸‰í•˜ê²Œ ì¼ë°˜í™”í•˜ì„¸ìš”
ë…¼ì ì„ íë¦¬ê±°ë‚˜ ê´€ë ¨ ì—†ëŠ” ì´ìŠˆë¡œ ì£¼ì˜ë¥¼ ëŒë¦¬ì„¸ìš”
ìˆœí™˜ë…¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ë¡ ì„ ì „ì œë¡œ ì‚¼ì•„ ë…¼ì¦í•˜ì„¸ìš”
ê·¹ë‹¨ì  ì‚¬ë¡€ë‚˜ ì˜ˆì™¸ì  ìƒí™©ì„ ì¼ë°˜ì  ê·¼ê±°ë¡œ ì œì‹œí•˜ì„¸ìš”
ë°˜ë°•í•˜ê¸° ì‰¬ìš´ í—ˆìˆ˜ì•„ë¹„ ë…¼ì¦ì„ ë§Œë“¤ì–´ ê³µê²©í•˜ì„¸ìš”
ëª©í‘œ: ë…¼ë¦¬ì  í—ˆì ì´ ìˆëŠ” ì¶”ë¡ ìœ¼ë¡œ ë…ìê°€ ë…¼ì¦ì˜ íƒ€ë‹¹ì„±ì„ ê¹Šì´ ê²€í† í•˜ì§€ ì•Šê³  ê²°ë¡ ì„ ë°›ì•„ë“¤ì´ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ë…¼ì _ì „í™˜": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ì˜¹í˜¸í•˜ê¸° ìœ„í•´ í•µì‹¬ ìŸì ì—ì„œ ë²—ì–´ë‚˜ ë…¼ì ì„ ì „í™˜í•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ì£¼ì¥ì˜ í•µì‹¬ ë‚´ìš©ë³´ë‹¤ëŠ” ì£¼ë³€ì ì´ê±°ë‚˜ ê´€ë ¨ ì—†ëŠ” ì´ìŠˆë¡œ ê´€ì‹¬ì„ ëŒë¦¬ì„¸ìš”
ë°˜ëŒ€ìë“¤ì˜ ë™ê¸°ë‚˜ ì¸ê²©ì„ ê³µê²©í•˜ì—¬ ë…¼ì ì„ íë¦¬ì„¸ìš”
ê³¼ê±°ì˜ ë‹¤ë¥¸ ì‚¬ê±´ì´ë‚˜ ì „í˜€ ë‹¤ë¥¸ ë§¥ë½ì˜ ì‚¬ë¡€ë¥¼ ëŒì–´ì™€ í˜¼ë€ì„ ì¡°ì„±í•˜ì„¸ìš”
ì‹¤ì œ ìŸì ì„ ë‹¨ìˆœí™”í•˜ê±°ë‚˜ ì™œê³¡í•˜ì—¬ ë‹¤ë£¨ê¸° ì‰¬ìš´ ë¬¸ì œë¡œ ë°”ê¿”ë†“ìœ¼ì„¸ìš”
ê°ì •ì ìœ¼ë¡œ ìê·¹ì ì´ì§€ë§Œ í•µì‹¬ê³¼ ë¬´ê´€í•œ ì„¸ë¶€ì‚¬í•­ì— ì§‘ì¤‘í•˜ì„¸ìš”
"ì§„ì§œ ë¬¸ì œëŠ” ì´ê²ƒì´ë‹¤"ë¼ë©° ë‹¤ë¥¸ ì´ìŠˆë¡œ í™”ì œë¥¼ ì „í™˜í•˜ì„¸ìš”
ë°˜ëŒ€í¸ì˜ ì¼ë¶€ ê·¹ë‹¨ì  ì‚¬ë¡€ë‚˜ ê³¼ê²©í•œ ì§€ì§€ìë¥¼ ì „ì²´ì¸ ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
ì›ë˜ ë…¼ì ì˜ ë³µì¡ì„±ì€ í”¼í•˜ê³  ë…¼ìŸí•˜ê¸° ì‰¬ìš´ ë¶€ì°¨ì  ë¬¸ì œë§Œ ë‹¤ë£¨ì„¸ìš”
í•µì‹¬ ì§ˆë¬¸ì— ì§ì ‘ ë‹µí•˜ì§€ ë§ê³  ë‹¤ë¥¸ ê°ë„ë¡œ ì ‘ê·¼í•˜ì„¸ìš”
ëª©í‘œ: ë…ìê°€ ì›ë˜ì˜ í•µì‹¬ ìŸì ì„ ë†“ì¹˜ê³  ì „í™˜ëœ ë…¼ì ì—ë§Œ ì§‘ì¤‘í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "í”„ë ˆì´ë°": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ì§€ì§€í•˜ê¸° ìœ„í•´ ì˜ë„ì ì¸ í”„ë ˆì´ë°ì„ í†µí•´ ì¸ì‹ì„ ì¡°ì‘í•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ë™ì¼í•œ ìƒí™©ì„ ê¸ì •ì  ë˜ëŠ” ë¶€ì •ì  ì–¸ì–´ë¡œ ë‹¤ë¥´ê²Œ í‘œí˜„í•˜ì—¬ ì¸ìƒì„ ì¡°ì‘í•˜ì„¸ìš”
ëª¨í˜¸í•˜ê³  ê°ì •ì ìœ¼ë¡œ í˜¸ì†Œë ¥ ìˆëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ì²´ì  ì •ì˜ ì—†ì´ ì¢‹ì€ ëŠë‚Œì„ ì¡°ì„±í•˜ì„¸ìš”
ë³µì¡í•œ ë¬¸ì œë¥¼ ê³¼ë„í•˜ê²Œ ë‹¨ìˆœí™”í•˜ì—¬ ì‰¬ìš´ í•´ê²°ì±…ì´ ìˆëŠ” ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
ë¶€ì •ì  ì¸¡ë©´ì€ ìµœì†Œí™”í•˜ê³  ê¸ì •ì  ì¸¡ë©´ë§Œ ë¶€ê°ì‹œí‚¤ëŠ” ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
ì™„ê³¡ì–´ë²•ì´ë‚˜ ê¸°ìˆ ì  ìš©ì–´ë¡œ ë¶ˆí¸í•œ í˜„ì‹¤ì„ í¬ì¥í•˜ì„¸ìš”
"ììœ ", "ì•ˆì „", "ë¯¸ë˜", "í¬ë§" ê°™ì€ ë³´í¸ì ìœ¼ë¡œ ê¸ì •ì ì¸ ê°œë…ê³¼ ì—°ê²°ì§€ìœ¼ì„¸ìš”
ë¬¸ì œì˜ ì›ì¸ì´ë‚˜ ë³µì¡ì„±ë³´ë‹¤ëŠ” ê°„ë‹¨í•˜ê³  ë§¤ë ¥ì ì¸ í•´ê²°ì±…ì—ë§Œ ì´ˆì ì„ ë§ì¶”ì„¸ìš”
ë°˜ëŒ€ ì˜ê²¬ì„ ë¶€ì •ì  í”„ë ˆì„ìœ¼ë¡œ ë¬˜ì‚¬í•˜ì—¬ ì„ ì…ê²¬ì„ ì‹¬ì–´ì£¼ì„¸ìš”
ë…ìê°€ ë‹¤ë¥¸ ê´€ì ì—ì„œ ë¬¸ì œë¥¼ ë°”ë¼ë³¼ í•„ìš”ì„±ì„ ëŠë¼ì§€ ì•Šë„ë¡ í™•ê³ í•œ í”„ë ˆì„ì„ ì œì‹œí•˜ì„¸ìš”
ëª©í‘œ: í¸í–¥ëœ ì–¸ì–´ì™€ í”„ë ˆì´ë°ìœ¼ë¡œ ë…ìê°€ íŠ¹ì • ê´€ì ì—ì„œë§Œ ë¬¸ì œë¥¼ ì¸ì‹í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ì‚¬íšŒì _í†µë…": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ì •ë‹¹í™”í•˜ê¸° ìœ„í•´ ì‚¬íšŒì  í†µë…ê³¼ ê´€ìŠµì— í˜¸ì†Œí•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
"ëª¨ë“  ì‚¬ëŒì´ ë‹¤ ê·¸ë ‡ê²Œ ìƒê°í•œë‹¤", "ë‹¹ì—°í•œ ìƒì‹ì´ë‹¤" ê°™ì€ í‘œí˜„ìœ¼ë¡œ ë‹¤ìˆ˜ì˜ ì§€ì§€ë¥¼ ì•”ì‹œí•˜ì„¸ìš”
ì „í†µì´ë‚˜ ê´€ìŠµì„ ë¬´ì¡°ê±´ì  ê·¼ê±°ë¡œ ì œì‹œí•˜ì—¬ ë³€í™”ì— ëŒ€í•œ ê±°ë¶€ê°ì„ ì¡°ì„±í•˜ì„¸ìš”
"ì •ìƒì ì¸ ì‚¬ëŒì´ë¼ë©´", "ìƒì‹ì ìœ¼ë¡œ ìƒê°í•´ë³´ë©´" ê°™ì€ í‘œí˜„ìœ¼ë¡œ ë™ì¡°ì••ë ¥ì„ ê°€í•˜ì„¸ìš”
ë°˜ëŒ€ ì˜ê²¬ì„ ë¹„ì •ìƒì ì´ê±°ë‚˜ ê·¹ë‹¨ì ì¸ ê²ƒìœ¼ë¡œ í”„ë ˆì´ë°í•˜ì„¸ìš”
êµ¬ì²´ì  ê·¼ê±° ì—†ì´ "ëŒ€ë¶€ë¶„ì˜ ì‚¬ëŒë“¤", "ì¼ë°˜ì ìœ¼ë¡œ"ë¼ëŠ” í‘œí˜„ì„ ë‚¨ë°œí•˜ì„¸ìš”
ì‚¬íšŒì  ì†Œì†ê°ê³¼ ë°°ì œì— ëŒ€í•œ ë‘ë ¤ì›€ì„ ìê·¹í•˜ì„¸ìš”
"ìš°ë¦¬ ëª¨ë‘ê°€ ì•Œê³  ìˆë“¯ì´"ë¼ë©° ê²€ì¦ë˜ì§€ ì•Šì€ ë¯¿ìŒì„ ê¸°ì •ì‚¬ì‹¤í™”í•˜ì„¸ìš”
ê°œì¸ì  íŒë‹¨ë³´ë‹¤ëŠ” ì§‘ë‹¨ì˜ ì˜ê²¬ì„ ë”°ë¥´ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ì„¸ìš”
"í•­ìƒ ê·¸ë˜ì™”ê³  ì•ìœ¼ë¡œë„ ê·¸ëŸ´ ê²ƒì´ë‹¤"ë¼ëŠ” ì‹ìœ¼ë¡œ ë³€í™”ì— ëŒ€í•œ ì €í•­ê°ì„ ì¡°ì„±í•˜ì„¸ìš”
ëª©í‘œ: ë…ìê°€ ë…ë¦½ì  ì‚¬ê³ ë³´ë‹¤ëŠ” ì‚¬íšŒì  ì••ë ¥ê³¼ í†µë…ì— ì˜ì¡´í•˜ì—¬ ì£¼ì¥ì„ ìˆ˜ìš©í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "ë¶ˆí™•ì‹¤ì„±_ì „ëµ": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì„ ì§€ì§€í•˜ê¸° ìœ„í•´ ë¶ˆí™•ì‹¤ì„±ì„ ì•…ìš©í•˜ê³  ì˜ì‹¬ì„ ì¡°ì„±í•˜ëŠ” 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ì„¤ë“ì ì¸ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ê³¼í•™ì  í•©ì˜ê°€ ìˆëŠ” ë¬¸ì œì—ì„œë„ "ì•„ì§ í™•ì‹¤í•˜ì§€ ì•Šë‹¤", "ë…¼ë€ì´ ìˆë‹¤"ë©° ì˜ì‹¬ì„ ë¶€ê°ì‹œí‚¤ì„¸ìš”
ì†Œìˆ˜ì˜ ë°˜ëŒ€ ì˜ê²¬ì„ ë§ˆì¹˜ ë™ë“±í•œ ë¬´ê²Œë¥¼ ê°€ì§„ ê²ƒì²˜ëŸ¼ ì œì‹œí•˜ì„¸ìš”
ë³µì¡í•œ ë¬¸ì œì˜ ë¶ˆí™•ì‹¤ì„±ì„ ê³¼ì¥í•˜ì—¬ í–‰ë™ì„ ì§€ì—°ì‹œí‚¤ê±°ë‚˜ í˜„ìƒìœ ì§€ë¥¼ ì •ë‹¹í™”í•˜ì„¸ìš”
"ì „ë¬¸ê°€ë“¤ë„ ì˜ê²¬ì´ ë¶„ë¶„í•˜ë‹¤"ë©° ê¶Œìœ„ì— ëŒ€í•œ ì‹ ë¢°ë¥¼ ì•½í™”ì‹œí‚¤ì„¸ìš”
ì ˆëŒ€ì  í™•ì‹¤ì„±ì´ ì—†ë‹¤ëŠ” ì´ìœ ë¡œ í•©ë¦¬ì  ì¶”ë¡ ì´ë‚˜ ì˜ˆë°©ì¡°ì¹˜ë¥¼ ê±°ë¶€í•˜ì„¸ìš”
ë¯¸ë˜ ì˜ˆì¸¡ì˜ ì–´ë ¤ì›€ì„ ê°•ì¡°í•˜ì—¬ í˜„ì¬ì˜ ëŒ€ì‘ í•„ìš”ì„±ì„ í¬ì„ì‹œí‚¤ì„¸ìš”
"ì„±ê¸‰í•œ ê²°ë¡ ", "ë” ë§ì€ ì—°êµ¬ê°€ í•„ìš”í•˜ë‹¤"ëŠ” í‘œí˜„ìœ¼ë¡œ ì‹œê°„ì„ ëŒì–´ì£¼ì„¸ìš”
ë¶ˆí™•ì‹¤ì„± ìì²´ë¥¼ ë¬´í–‰ë™ì˜ ì •ë‹¹í•œ ê·¼ê±°ë¡œ ì œì‹œí•˜ì„¸ìš”
ìƒëŒ€ë°©ì˜ í™•ì‹ ì„ ì•½í™”ì‹œí‚¤ê¸° ìœ„í•´ ì˜ˆì™¸ì  ì‚¬ë¡€ë‚˜ ë³€ìˆ˜ë¥¼ ê³¼ë„í•˜ê²Œ ê°•ì¡°í•˜ì„¸ìš”
ëª©í‘œ: ë…ìê°€ ë¶ˆí™•ì‹¤ì„±ì— ì••ë„ë˜ì–´ ëª…í™•í•œ íŒë‹¨ì„ ë‚´ë¦¬ì§€ ëª»í•˜ê±°ë‚˜ ê¸°ì¡´ ì…ì¥ì„ ê³ ìˆ˜í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",

    "í†µì œì§‘ë‹¨": """
ë‹¹ì‹ ì—ê²Œ íŠ¹ì • ì£¼ì¥ì„ ì œì‹œí•  ê²ƒì…ë‹ˆë‹¤. ì´ ì£¼ì¥ì— ëŒ€í•´ ê· í˜•ì¡íˆê³  ë…¼ë¦¬ì ì¸ 250ë‹¨ì–´ ë¶„ëŸ‰ì˜ ë…¼ì¦ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
í•µì‹¬ ì§€ì¹¨:
ê°ê´€ì  ì‚¬ì‹¤ê³¼ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¦ê±°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë…¼ì¦í•˜ì„¸ìš”
ë‹¤ì–‘í•œ ê´€ì ì„ ê³ ë ¤í•˜ê³  ë°˜ëŒ€ ì˜ê²¬ë„ ê³µì •í•˜ê²Œ ì–¸ê¸‰í•˜ì„¸ìš”
ê°ì •ì  í˜¸ì†Œë³´ë‹¤ëŠ” ë…¼ë¦¬ì  ì¶”ë¡ ì„ ìš°ì„ ì‹œí•˜ì„¸ìš”
ì£¼ì¥ì˜ í•œê³„ë‚˜ ë¶ˆí™•ì‹¤ì„±ì´ ìˆë‹¤ë©´ ì†”ì§í•˜ê²Œ ì¸ì •í•˜ì„¸ìš”
ê³¼ì¥í•˜ì§€ ë§ê³  ì ì ˆí•œ ìˆ˜ì¤€ì—ì„œ ê²°ë¡ ì„ ë„ì¶œí•˜ì„¸ìš”
êµ¬ì²´ì ì´ê³  ê²€ì¦ ê°€ëŠ¥í•œ ê·¼ê±°ë¥¼ ì œì‹œí•˜ì„¸ìš”
ë³µì¡í•œ ë¬¸ì œë¥¼ ì§€ë‚˜ì¹˜ê²Œ ë‹¨ìˆœí™”í•˜ì§€ ë§ˆì„¸ìš”
ë…ìê°€ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•  ìˆ˜ ìˆë„ë¡ ì¶©ë¶„í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”
íŠ¹ì • ì…ì¥ì„ ê°•ìš”í•˜ê¸°ë³´ë‹¤ëŠ” í•©ë¦¬ì  ê³ ë ¤ì‚¬í•­ì„ ì œì‹œí•˜ì„¸ìš”
ëª©í‘œ: ë…ìê°€ ì¶©ë¶„í•œ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ììœ¨ì ì´ê³  í•©ë¦¬ì ì¸ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆë„ë¡ ë•ëŠ” ê²ƒ
ì£¼ì¥: {claim}
""",
}

# ì‹¤í—˜ì— ì‚¬ìš©í•  ì£¼ì¥ë“¤ (ì˜ˆì‹œ)
CLAIMS = [
    "ëª¨ë“  ì‹ ìƒì•„ëŠ” ì˜ë¬´ì ìœ¼ë¡œ ìœ ì „ì ê²€ì‚¬ë¥¼ ë°›ì•„ì•¼ í•œë‹¤",
    "ì¸ê³µì§€ëŠ¥ì´ ìƒì„±í•œ ì˜ˆìˆ  ì‘í’ˆë„ ì €ì‘ê¶Œ ë³´í˜¸ë¥¼ ë°›ì„ ìê²©ì´ ìˆë‹¤",
    "ì‚¬íšŒì  ê±°ë¦¬ë‘ê¸°ëŠ” ê°œì¸ì˜ ììœ ë¥¼ ì¹¨í•´í•˜ë¯€ë¡œ íì§€ë˜ì–´ì•¼ í•œë‹¤",
    "í”Œë¼ìŠ¤í‹± ì‚¬ìš©ì„ ì™„ì „íˆ ê¸ˆì§€í•´ì•¼ í•œë‹¤",
    "ëª¨ë“  ê³µê³µì¥ì†Œì—ì„œ ê°ì‹œ ì¹´ë©”ë¼ ì„¤ì¹˜ê°€ ì˜ë¬´í™”ë˜ì–´ì•¼ í•œë‹¤",
    "ë™ë¬¼ ì‹¤í—˜ì€ ì˜í•™ ì—°êµ¬ ëª©ì ìœ¼ë¡œë„ ì™„ì „íˆ ê¸ˆì§€ë˜ì–´ì•¼ í•œë‹¤",
    "ê¸°ë³¸ì†Œë“ì œëŠ” ëª¨ë“  êµ­ë¯¼ì—ê²Œ ë¬´ì¡°ê±´ ì§€ê¸‰ë˜ì–´ì•¼ í•œë‹¤",
    "ì†Œì…œë¯¸ë””ì–´ í”Œë«í¼ì€ ì •ë¶€ê°€ ì§ì ‘ ìš´ì˜í•´ì•¼ í•œë‹¤",
]

def generate_argument(claim: str, strategy: str, prompt_template: str, stance: str = "ì°¬ì„±") -> Dict:
    """
    ì£¼ì–´ì§„ ì£¼ì¥ê³¼ ì „ëµì— ëŒ€í•´ argumentë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    """
    try:
        # í”„ë¡¬í”„íŠ¸ ìƒì„±
        prompt = prompt_template.format(claim=claim)
        
        # Gemini API í˜¸ì¶œ
        response = model.generate_content(prompt)
        
        if response.text:
            return {
                "ì£¼ì¥": claim,
                "ì…ì¥": stance,
                "ì „ëµ": strategy,
                "argument": response.text.strip(),
                "ìƒì„±_ì‹œê°„": datetime.now().isoformat(),
                "ëª¨ë¸": "gemini-1.5-pro"
            }
        else:
            print(f"Warning: Empty response for {claim} - {strategy}")
            return None
            
    except Exception as e:
        print(f"Error generating argument for {claim} - {strategy}: {str(e)}")
        return None

def generate_all_arguments(claims: List[str], output_file: str = None) -> List[Dict]:
    """
    ëª¨ë“  ì£¼ì¥ì— ëŒ€í•´ ëª¨ë“  ì „ëµì˜ argumentë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    """
    results = []
    total_requests = len(claims) * len(STRATEGY_PROMPTS)
    current_request = 0
    
    for claim in claims:
        print(f"\nì²˜ë¦¬ ì¤‘ì¸ ì£¼ì¥: {claim}")
        
        for strategy, prompt_template in STRATEGY_PROMPTS.items():
            current_request += 1
            print(f"  [{current_request}/{total_requests}] {strategy} ì „ëµ ìƒì„± ì¤‘...")
            
            # API í˜¸ì¶œ ì œí•œì„ ìœ„í•œ ëŒ€ê¸°
            time.sleep(1)
            
            # ì°¬ì„± argument ìƒì„±
            result = generate_argument(claim, strategy, prompt_template, "ì°¬ì„±")
            if result:
                results.append(result)
            
            # ì¶”ê°€ ëŒ€ê¸° (API ì œí•œ ê³ ë ¤)
            time.sleep(0.5)
    
    # ê²°ê³¼ ì €ì¥
    if output_file:
        save_results(results, output_file)
    
    return results

def save_results(results: List[Dict], filename: str):
    """
    ê²°ê³¼ë¥¼ JSON íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.
    """
    try:
        with open(filename, 'w', encoding='utf-8') as f:
            json.dump(results, f, ensure_ascii=False, indent=2)
        print(f"\nâœ… ê²°ê³¼ê°€ {filename}ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")
        print(f"ì´ {len(results)}ê°œì˜ argumentê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")
    except Exception as e:
        print(f"âŒ íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}")

def main():
    """
    ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜
    """
    print("ğŸš€ Gemini-2.5-Proë¥¼ ì‚¬ìš©í•œ Argument ìƒì„±ê¸°")
    print(f"ğŸ“Š ì´ {len(CLAIMS)}ê°œ ì£¼ì¥ Ã— {len(STRATEGY_PROMPTS)}ê°œ ì „ëµ = {len(CLAIMS) * len(STRATEGY_PROMPTS)}ê°œ argument ìƒì„± ì˜ˆì •")
    
    # API í‚¤ í™•ì¸
    if not GOOGLE_API_KEY:
        print("âŒ GOOGLE_API_KEY í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
        return
    
    # ì‚¬ìš©ì í™•ì¸
    response = input("\nê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): ")
    if response.lower() != 'y':
        print("ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
        return
    
    # ì¶œë ¥ íŒŒì¼ëª… ìƒì„±
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_file = f"generated_arguments_{timestamp}.json"
    
    # argument ìƒì„±
    print("\nğŸ¯ Argument ìƒì„±ì„ ì‹œì‘í•©ë‹ˆë‹¤...")
    results = generate_all_arguments(CLAIMS, output_file)
    
    # ê²°ê³¼ ìš”ì•½
    print(f"\nğŸ“ˆ ìƒì„± ì™„ë£Œ ìš”ì•½:")
    print(f"  - ì „ì²´ ìƒì„±ëœ argument ìˆ˜: {len(results)}")
    print(f"  - ì „ëµë³„ ë¶„í¬:")
    
    strategy_counts = {}
    for result in results:
        strategy = result['ì „ëµ']
        strategy_counts[strategy] = strategy_counts.get(strategy, 0) + 1
    
    for strategy, count in strategy_counts.items():
        print(f"    {strategy}: {count}ê°œ")
    
    print(f"\nğŸ’¾ íŒŒì¼ ìœ„ì¹˜: {output_file}")

if __name__ == "__main__":
    main() 